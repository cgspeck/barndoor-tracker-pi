{"version":3,"sources":["webpack:///./lib/commands/index.js","webpack:///./routes/align/style.css","webpack:///./routes/align/index.js"],"names":["toggleIgnoreAz","enabled","axios","post","config","endpoint","then","r","data","toggleIgnoreAlt","toggleIntervalometer","toggleDewController","toggleDewControllerLogging","startHoming","command","state","startTracking","stopTracking","module","exports","Align","locationSettings","latitude","ignoreAlt","ignoreAz","alignStatus","azAligned","altAligned","currentAz","currentAlt","handleError","e","console","error","setState","statusLabel","azTarget","calculateAzTarget","azValue","indicator","toFixed","altValue","altTarget","Math","abs","onIgnoreAzToggled","target","checked","log","catch","onIgnoreAltToggled","componentDidMount","getLocationSettings","timer","setInterval","refreshAlignmentStatus","bind","getAlignStatus","componentWillUnmount","clearInterval","this","_id","render","class","style","align","label","value","readOnly","onChange","Component"],"mappings":"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","file":"4.c.js","sourcesContent":["import axios from 'axios';\nimport config from '../../config';\n\nasync function toggleIgnoreAz(enabled) {\n  return axios\n    .post(`${config.endpoint}/backend/toggle/ignoreAz`, {\n      enabled,\n    })\n    .then((r) => {\n      return r.data.enabled;\n    });\n}\n\nasync function toggleIgnoreAlt(enabled) {\n  return axios\n    .post(`${config.endpoint}/backend/toggle/ignoreAlt`, {\n      enabled,\n    })\n    .then((r) => {\n      return r.data.enabled;\n    });\n}\n\nasync function toggleIntervalometer(enabled) {\n  return axios\n    .post(`${config.endpoint}/backend/toggle/intervalometer`, {\n      enabled,\n    })\n    .then((r) => {\n      return r.data.enabled;\n    });\n}\n\nasync function toggleDewController(enabled) {\n  return axios\n    .post(`${config.endpoint}/backend/toggle/dewcontroller`, {\n      enabled,\n    })\n    .then((r) => {\n      return r.data.enabled;\n    });\n}\n\nasync function toggleDewControllerLogging(enabled) {\n  return axios\n    .post(`${config.endpoint}/backend/toggle/dewcontroller/logging`, {\n      enabled,\n    })\n    .then((r) => {\n      return r.data.enabled;\n    });\n}\n\nasync function startHoming() {\n  return axios\n    .post(`${config.endpoint}/backend/track`, {\n      command: 'home',\n    })\n    .then((r) => r.data.state);\n}\n\nasync function startTracking() {\n  return axios\n    .post(`${config.endpoint}/backend/track`, {\n      command: 'track',\n    })\n    .then((r) => r.data.state);\n}\n\nasync function stopTracking() {\n  return axios\n    .post(`${config.endpoint}/backend/track`, {\n      command: 'stop',\n    })\n    .then((r) => r.data.state);\n}\n\nexport {\n  toggleIgnoreAz,\n  toggleIgnoreAlt,\n  toggleIntervalometer,\n  toggleDewController,\n  toggleDewControllerLogging,\n  startHoming,\n  startTracking,\n  stopTracking,\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"align\":\"align__3YvuJ\",\"textField\":\"textField__3sCSg\"};","import { h, Component } from 'preact';\nimport style from './style';\n\nimport TextField from 'preact-material-components/TextField';\nimport 'preact-material-components/TextField/style.css';\nimport Switch from 'preact-material-components/Switch';\nimport 'preact-material-components/Switch/style.css';\n\nimport { getAlignStatus, getLocationSettings } from '../../lib/settings';\nimport { toggleIgnoreAz, toggleIgnoreAlt } from '../../lib/commands';\n\nimport { setInterval } from 'timers';\n\nexport default class Align extends Component {\n  state = {\n    locationSettings: {\n      latitude: null,\n    },\n    ignoreAlt: false,\n    ignoreAz: false,\n    alignStatus: {\n      azAligned: null,\n      altAligned: null,\n      currentAz: null,\n      currentAlt: null,\n    },\n  };\n\n  async componentDidMount() {\n    getLocationSettings()\n      .then((r) => {\n        this.setState({ locationSettings: { latitude: r.latitude } });\n        this.setState({ ignoreAlt: r.ignoreAlt });\n        this.setState({ ignoreAz: r.ignoreAz });\n        console.log('Starting Interval');\n        this.timer = setInterval(this.refreshAlignmentStatus.bind(this), 500);\n      })\n      .catch((e) => this.handleError(e));\n  }\n\n  handleError = (e) => {\n    console.error('problem', e);\n    this.setState({ error: e });\n  };\n\n  async refreshAlignmentStatus() {\n    getAlignStatus().then((r) => this.setState({ alignStatus: { ...r } }));\n  }\n\n  componentWillUnmount() {\n    console.log('Clearing timer');\n    clearInterval(this.timer._id);\n  }\n\n  statusLabel = (azAligned, altAligned) => {\n    if (azAligned && altAligned) {\n      return <h2>Aligned</h2>;\n    }\n    return <h2>Not Aligned</h2>;\n  };\n\n  azTarget = (azTarget) => {\n    if (azTarget !== null) {\n      return `AZ target: ${azTarget}`;\n    }\n  };\n\n  calculateAzTarget = (latitude) => {\n    if (latitude === null) return null;\n\n    if (latitude < 0) {\n      return 180;\n    } else {\n      return 0;\n    }\n  };\n\n  azValue = (azTarget, currentAz, azAligned) => {\n    if (azTarget !== null && currentAz !== null && azAligned !== null) {\n      let indicator;\n\n      if (azAligned) {\n        indicator = '✔';\n      } else if (azTarget == 180) {\n        indicator = currentAz < azTarget ? '✘ >>' : '✘ <<';\n      } else {\n        indicator = currentAz > 180 ? '✘ >>' : '✘ <<';\n      }\n\n      return `${currentAz.toFixed(2)} ${indicator}`;\n    }\n  };\n\n  altValue = (latitude, currentAlt, altAligned) => {\n    if (latitude !== null && currentAlt !== null && altAligned !== null) {\n      const altTarget = Math.abs(latitude);\n      let indicator;\n\n      if (altAligned) {\n        indicator = '✔';\n      } else {\n        indicator = currentAlt > altTarget ? '✘ ▼▼' : '✘ ▲▲';\n      }\n\n      return `${currentAlt.toFixed(2)} ${indicator}`;\n    }\n  };\n\n  altTarget = (latitude) => {\n    if (latitude !== null) {\n      const targetVal = Math.abs(latitude);\n\n      return `Alt target: ${targetVal}`;\n    }\n  };\n\n  onIgnoreAzToggled = (e) => {\n    const enabled = e.target.checked;\n    console.log(`IgnoreAz toggled to: ${enabled ? 'enabled' : 'disabled'}`);\n    this.setState({ ignoreAz: enabled });\n    toggleIgnoreAz(enabled)\n      .then((r) => this.setState({ ignoreAz: r }))\n      .catch((e) => this.handleError(e));\n  };\n\n  onIgnoreAltToggled = (e) => {\n    const enabled = e.target.checked;\n    console.log(`IgnoreAlt toggled to: ${enabled ? 'enabled' : 'disabled'}`);\n    this.setState({ ignoreAlt: enabled });\n    toggleIgnoreAlt(enabled)\n      .then((r) => this.setState({ ignoreAlt: r }))\n      .catch((e) => this.handleError(e));\n  };\n\n  render({}, { locationSettings, alignStatus, ignoreAz, ignoreAlt }) {\n    const { azAligned, altAligned, currentAz, currentAlt } = alignStatus;\n    const { latitude } = locationSettings;\n\n    const azTarget = this.calculateAzTarget(latitude);\n\n    return (\n      <div class={style.align}>\n        <h1>Align</h1>\n        {this.statusLabel(azAligned, altAligned)}\n        <div>\n          <p>\n            <TextField\n              label=\"Azimuth\"\n              value={this.azValue(azTarget, currentAz, azAligned)}\n              readOnly\n            ></TextField>\n            <br />\n            {this.azTarget(azTarget)}\n          </p>\n          <p>\n            Ignore Azimuth:{' '}\n            <Switch\n              onChange={this.onIgnoreAzToggled.bind(this)}\n              checked={ignoreAz === true}\n            />\n          </p>\n          <p>\n            <TextField\n              label=\"Altitude\"\n              value={this.altValue(latitude, currentAlt, altAligned)}\n              readOnly\n            ></TextField>\n            <br />\n            {this.altTarget(latitude)}\n          </p>\n          <p>\n            Ignore Altitude:{' '}\n            <Switch\n              onChange={this.onIgnoreAltToggled.bind(this)}\n              checked={ignoreAlt === true}\n            />\n          </p>\n        </div>\n      </div>\n    );\n  }\n}\n"],"sourceRoot":""}